<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson - MED-Portal</title>
    <link rel="stylesheet" href="assets/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <header class="site-header">
        <div class="container header-container">
            <h1><a href="index.html">MED-Portal</a></h1>
            <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle light/dark theme">
                <svg id="theme-icon-light" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                <svg id="theme-icon-dark" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </button>
        </div>
    </header>

    <main>
        <div class="container">
            <a id="back-to-lessons-link" href="#" class="back-link">&larr; Back to Lessons</a>
            <h2 id="lesson-title" class="page-title">Loading Lesson...</h2>
            
            <div class="tabs">
                <button class="tab-link active" data-tab="lesson-content">Lesson</button>
                <button class="tab-link" data-tab="flashcards-content">Flash Cards</button>
                <button class="tab-link" data-tab="quiz-content">MCQs</button>
            </div>

            <div id="lesson-content" class="tab-content active">
                <div id="lesson-body-skeleton" class="content-skeleton"></div>
                <div id="lesson-body" class="lesson-body-content"></div>
            </div>

            <div id="flashcards-content" class="tab-content">
                <div id="flashcards-body-skeleton" class="content-skeleton"></div>
                <div id="flashcards-container"></div>
            </div>

            <div id="quiz-content" class="tab-content">
                <div id="quiz-body-skeleton" class="content-skeleton"></div>
                <div id="quiz-container"></div>
            </div>
        </div>
    </main>
    
    <button id="ai-tutor-fab" aria-label="Open AI Tutor">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9-9 9-9-1.8-9-9 1.8-9 9-9Z"/><path d="m8 12 2.5 2.5"/><path d="m14 12-2.5 2.5"/><path d="M12 17v.01"/></svg>
    </button>

    <div id="ai-modal-overlay" class="modal-overlay">
        <div id="api-key-modal" class="modal-window">
             <h3>Activate AI Tutor</h3>
             <p>To enable the AI-powered assistant, please enter your Gemini API key.</p>
             <input type="password" id="api-key-input" placeholder="Enter your API key here">
             <div class="modal-actions">
                <button id="cancel-api-key-btn" class="modal-btn secondary">Cancel</button>
                <button id="save-api-key-btn" class="modal-btn primary">Save & Start</button>
             </div>
        </div>
        <div id="chat-modal" class="modal-window chat-window">
            <div class="chat-header">
                <h3>AI Tutor</h3>
                <button id="close-chat-btn" class="close-btn">&times;</button>
            </div>
            <div id="chat-messages"></div>
            <form id="chat-form">
                <input type="text" id="chat-input" placeholder="Ask about this lesson...">
                <button type="submit" aria-label="Send message">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </form>
        </div>
    </div>

    <footer class="site-footer">
        <p>By Abdallah Hamza</p>
    </footer>

    <script src="js/github.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/lesson.js"></script>
</body>
</html>
